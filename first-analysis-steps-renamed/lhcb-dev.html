

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developing LHCb Software &mdash; FCC Starterkit Lessons  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/panels.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/panels.css" type="text/css" />
  <link rel="stylesheet" href="../_static/starterkit.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> FCC Starterkit Lessons
          

          
            
            <img src="../_static/starterkit.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../software-basics/README.html">First  Steps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/prerequisites.html">Pre-workshop checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/introduction-to-course.html">Goals of the course</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/fccsw.html">An introduction to FCC Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/bookkeeping.html">Finding data in the Bookkeeping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/exploring-fcc-files.html">Inspecting an FCC data file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../software-basics/exploring-fcc-files.html#the-events-tree">The <code class="docutils literal notranslate"><span class="pre">events</span></code> tree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../software-basics/exploring-fcc-files.html#the-metadata-tree">The <code class="docutils literal notranslate"><span class="pre">metadata</span></code> tree</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../software-basics/asking-questions.html">Asking good questions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../fast-sim-and-analysis/README.html">Generators, Fast Simulation and Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html">FCC: Getting started with the production and analysis of fast-simulated events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#installation">Installation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#set-up-your-working-directory">Set up your working directory</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#getting-started-with-delphes">Getting started with Delphes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#run-fccsw-with-pythia8-delphes">Run FCCSW with Pythia8+Delphes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#run-the-analysis-in-heppy">Run the analysis in heppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#make-plots">Make plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#cutflow">CutFlow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#legacy-using-the-papas-tool-for-fcc-ee">Legacy: using the Papas tool (for FCC-ee)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#id1">Set up your working directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#generate-events-with-pythia8">Generate events with pythia8</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#run-papas-and-the-analysis-in-heppy">Run papas and the analysis in heppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#id2">Make plots</a></li>
<li class="toctree-l4"><a class="reference internal" href="../fast-sim-and-analysis/FccSoftwareGettingStartedFastSim.html#more-information">More information</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html">FCC-hh: Pythia, Delphes, Heppy Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html#part-i-generate-and-simulate-events-with-fccsw">Part I: Generate and simulate Events with FCCSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html#part-ii-analyze-the-output-with-heppy">Part II: Analyze the output with Heppy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html#part-iii-produce-plots">Part III: Produce plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html#part-iv-homework">Part IV: Homework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FccFullAnalysis.html#other-documentation">Other documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../fast-sim-and-analysis/FcceeAnalysis.html">FCC-ee: Getting started with analysing simulated physics events</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FcceeAnalysis.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FcceeAnalysis.html#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FcceeAnalysis.html#instructions">Instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fast-sim-and-analysis/FcceeAnalysis.html#exercices">Exercices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../full-detector-simulations/README.html">Full Detector Simulations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html">FCC Calorimeter Performance Studies Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#using-the-dd4hep-detector-model-in-fcc-software">Using the DD4hep detector model in FCC Software.</a></li>
<li class="toctree-l3"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#running-geant4-within-the-fcc-software-framework">Running Geant4 within the FCC Software Framework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#obtaining-and-plotting-the-energy-resolution">Obtaining and Plotting the Energy Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#extracting-and-plotting-the-resolution">Extracting and Plotting the Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#further-topics-parametrizing-the-energy-resolution">Further Topics: Parametrizing the Energy Resolution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../full-detector-simulations/FccCaloPerformance.html#further-topics-calculating-the-sampling-fraction-and-using-it-in-simulation">Further Topics: Calculating the Sampling Fraction and using it in Simulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../full-detector-simulations/FCCeeDriftChamber.html">FCCee: Full Simulation of IDEA Driftchamber</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../full-detector-simulations/FCCeeDriftChamber.html#part-i-simulations-with-the-idea-detector-model-in-fccsw">Part I: Simulations with the IDEA detector model in  FCCSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../full-detector-simulations/FCCeeDriftChamber.html#part-ii-user-task-basic-reconstruction-with-a-hough-transform">Part II User Task: Basic Reconstruction with a Hough-Transform</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developing-fcc-software/README.html">Developing FCCSW</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html">Github workflow and contribution guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#first-time-setup-of-git">First time setup of git</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#generate-and-set-up-ssh-keys-for-github">Generate and set up ssh keys for github</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#improving-your-git-experience">Improving your git experience</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#development-workflow">Development workflow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#keeping-your-local-repository-up-to-date">Keeping your local repository up to date</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#contributing-code">Contributing code</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#recommendations">Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#general-recommendations">General recommendations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#commit-comments">Commit comments</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#cleaning-history">Cleaning history</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#pull-requests">Pull requests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#trouble-shooting">Trouble-shooting</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#when-i-try-to-push-to-the-repository-i-get-an-authentication-error">When I try to push to the repository, I get an authentication error</a></li>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#i-have-cloned-with-https-and-now-i-can-t-push-my-changes-what-do-i-do">I have cloned with https and now I can’t push my changes, what do I do?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccSoftwareGit.html#need-help">Need help?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html">CMake guide for the FCC software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#quick-start-into-building-fccsw">Quick start into building FCCSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#cmake-example-packages">CMake example packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#cmake-in-the-fcc-software-framework">CMake in the FCC software framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#ctest-in-fccsw">CTest in FCCSW</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#using-an-internal-library">Using an internal library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#building-a-new-gaudi-module">Building a new Gaudi module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#using-an-external-library">Using an external library</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccCMakeGuide.html#customizing-how-cmake-is-run">Customizing how CMake is run</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html">Writing documentation for the FCC software</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#where-to-put-documentation">Where to put documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#when-and-how-is-the-documentation-page-updated">When and how is the documentation page updated?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#structure-of-the-content">Structure of the content</a></li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#running-website-generation-locally">Running website generation locally</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#about-jekyll">About jekyll</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../developing-fcc-software/FccDocPage.html#for-website-admins">For website admins</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#getting-started">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../CONTRIBUTING.html#dependencies">Dependencies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../CONDUCT.html">Contributor Code of Conduct</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LICENSE.html">Instructional Material</a></li>
<li class="toctree-l3"><a class="reference internal" href="../LICENSE.html#software">Software</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">External links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://hsf-training.github.io/analysis-essentials/">Analysis essentials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://lhcb.github.io/starterkit">LHCb starterkit</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hep-fcc.github.io/glossary">FCC software glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">FCC Starterkit Lessons</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Developing LHCb Software</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/HEP-FCC/fcc-tutorials/blob/master/first-analysis-steps-renamed/lhcb-dev.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="developing-lhcb-software">
<h1>Developing LHCb Software<a class="headerlink" href="#developing-lhcb-software" title="Permalink to this headline">¶</a></h1>
<div class="panel panel-objectives docutils container">
<div class="panel-header open docutils container">
<p id="learning-objectives"><i class="fa fa-line-chart"></i> Learning Objectives</p>
</div>
<div class="panel-body docutils container">
<ul class="simple">
<li><p>Learn how to work with and modify LHCb software projects and packages</p></li>
<li><p>Learn how to find and search the source code and its documentation</p></li>
</ul>
</div>
</div>
<div class="panel panel-prereq docutils container">
<div class="panel-header open docutils container">
<p id="prerequisites"><i class="fa fa-rocket"></i> Prerequisites</p>
</div>
<div class="panel-body docutils container">
<p>Before starting, you should have a basic understanding of how to use <code class="docutils literal notranslate"><span class="pre">git</span></code>,
similar to what has been
<a class="reference external" href="https://hsf-training.github.io/analysis-essentials/git">taught</a> during the
Starterkit.</p>
</div>
</div>
<p>In this lesson, we’ll show you a complete workflow for developing the LHCb
software using the <code class="docutils literal notranslate"><span class="pre">git</span></code> version control system.  At LHCb, we use GitLab to
manage our git repositories.  Among other features, GitLab allows you to browse
the source code for each project, and to review new changes (called <em>merge
requests</em>) in a convenient web interface.  You can find the CERN GitLab
instance at https://gitlab.cern.ch.</p>
<p>In principle, there are multiple ways of interacting with the LHCb software
repositories:</p>
<ol class="simple">
<li><p>A vanilla git workflow using only the standard git commands.  This requires
you to <code class="docutils literal notranslate"><span class="pre">clone</span></code> and compile an entire LHCb project at a time.</p></li>
<li><p>An LHCb-specific workflow using a set of <code class="docutils literal notranslate"><span class="pre">lb-*</span></code> subcommands.  This allows
you to check out individual packages inside a project, and streamlines the
modification of a few packages at a time.  (This is closer to the previously
used <code class="docutils literal notranslate"><span class="pre">getpack</span></code> command.)</p></li>
</ol>
<p>Here, we want to focus on the second workflow. The first workflow will be
discussed briefly at the <a class="reference external" href="#working-with-a-full-project-checkout">bottom</a> of
this page. Note that, although the lb-git commands are much easier for small
changes to existing packages where recompiling an entire project would be
cumbersome, for any serious development the usage of vanilla git is much more
stable. Please consider using it if you can spare the compilation time.</p>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="initial-setup"><i class="fa fa-info-circle"></i> Initial setup</p>
</div>
<div class="panel-body docutils container">
<p>Before jumping in by creating a project in GitLab, you should make sure that
your local git configuration and your settings on GitLab are sufficiently set
up.</p>
<ul class="simple">
<li><p>Your name and email address should be set up in your local <code class="docutils literal notranslate"><span class="pre">git</span></code>
configuration.  To ensure that this is the case, run</p></li>
</ul>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git config --global user.name &quot;Your Name&quot;
git config --global user.email &quot;Your Name &lt;your.name@cern.ch&gt;&quot;
</pre></div>
</div>
<p>and put in your information.</p>
<ul>
<li><p>Next, connect to https://gitlab.cern.ch and log in with your CERN
credentials. Visit https://gitlab.cern.ch/profile/keys and add an SSH key.</p></li>
<li><p>Finally, run this LHCb-specific configuration command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>git config --global lb-use.protocol ssh
</pre></div>
</div>
<p>This makes sure the LHCb commands use the ssh protocol instead of https.</p>
</li>
</ul>
</div>
</div>
<p>This lesson introduces you the commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lb-dev</span></code> for setting up a new development environment</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-use</span></code> and <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-checkout</span></code> for downloading LHCb software packages</p></li>
</ul>
<p>If you want to make changes to a software package, you will need to set up a
development environment. <code class="docutils literal notranslate"><span class="pre">lb-dev</span></code> is your friend here:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lb-dev --name DaVinciDev DaVinci/v45r1
</pre></div>
</div>
<p>The output should look similar to this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Successfully created the local project DaVinciDev in .

To start working:

  &gt; cd ./DaVinciDev
  &gt; git lb-use DaVinci
  &gt; git lb-checkout DaVinci/vXrY MyPackage

then

  &gt; make
  &gt; make test

and optionally (CMake only)

  &gt; make install

You can customize the configuration by editing the files &#39;build.conf&#39; and
&#39;CMakeLists.txt&#39; (see https://cern.ch/gaudi/CMake for details).
</pre></div>
</div>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="lb-dev-created-local-projects-are-git-repositories"><i class="fa fa-info-circle"></i> lb-dev created local projects are Git repositories</p>
</div>
<div class="panel-body docutils container">
<p>When <code class="docutils literal notranslate"><span class="pre">lb-dev</span></code> creates the local project directory and create the initial
files there, it also calls <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span></code> and commits to the local Git repository
the first version of the files (try with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">log</span></code> in there).</p>
<p>You can then use git to keep track of your development, and share your code
with others (for example with a <a class="reference external" href="https://gitlab.cern.ch/projects/new">new project in
gitlab.cern.ch</a>).</p>
</div>
</div>
<p>Follow those instructions to compile the software:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> DaVinciDev
git lb-use DaVinci
make
</pre></div>
</div>
<p>Once that’s done, you can do</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run bash -l
</pre></div>
</div>
<p>inside the directory. This will (similar to <code class="docutils literal notranslate"><span class="pre">lb-run</span></code>) give you a new bash
session with the right environment variables set, from which you can run
project-specific commands such as <code class="docutils literal notranslate"><span class="pre">gaudirun.py</span></code>.</p>
<p>Your new development environment won’t be very useful without any software to
modify and build.  So let’s check out one of the existing LHCb packages! These
are stored in the <a class="reference external" href="https://gitlab.cern.ch/lhcb">LHCb Git repositories</a>.</p>
<p>In order to obtain the source code of the package you want to work on, we’ll
use the <a class="reference external" href="https://twiki.cern.ch/twiki/bin/view/LHCb/Git4LHCb">Git4LHCb</a> scripts.
These are a set of aliases, starting with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-</span></code>, that are designed to make
developing LHCb software easier.  For example, if you want to write a custom
stripping selection, execute the following in the <code class="docutils literal notranslate"><span class="pre">DaVinciDev</span></code> directory:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git lb-use Stripping
git lb-checkout Stripping/master Phys/StrippingSelections
make configure
</pre></div>
</div>
<p>Under the hood, <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-use</span></code> will add the
<a class="reference external" href="https://gitlab.cern.ch/lhcb/Stripping"><code class="docutils literal notranslate"><span class="pre">Stripping</span></code></a> repository as a remote in
git – check this with <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">remote</span> <span class="pre">-v</span></code>!  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-checkout</span></code> will then perform a
<em>partial</em> checkout of the master branch of the Stripping repository, only
adding the files under
<a class="reference external" href="https://gitlab.cern.ch/lhcb/Stripping/tree/master/Phys/StrippingSelections"><code class="docutils literal notranslate"><span class="pre">Phys/StrippingSelections</span></code></a>.</p>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="which-project-to-use-in-git-lb-use?"><i class="fa fa-info-circle"></i> Which project to use in git lb-use?</p>
</div>
<div class="panel-body docutils container">
<p>The project name to pass to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-use</span></code> depends on the directories you want
to check out and work on, and not on the project name you passed to <code class="docutils literal notranslate"><span class="pre">lb-dev</span></code>.
Moreover you can call <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-use</span></code> several times for different remote
projects in the same local project:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lb-dev --name DaVinciDev DaVinci/v45r1
<span class="nb">cd</span> DaVinciDev
git lb-use Analysis
git lb-use Stripping
git lb-use DaVinci
</pre></div>
</div>
<p>Not that in order for this to work, projects you specify in <code class="docutils literal notranslate"><span class="pre">lb-use</span></code> may not
depend on the project you specify in <code class="docutils literal notranslate"><span class="pre">lb-dev</span></code>. In other words, the top-level
project should be at the top of the <a class="reference external" href="https://lhcb-comp.web.cern.ch/lhcb-comp/">dependency
chain</a>.</p>
</div>
</div>
<p>You can now modify the <code class="docutils literal notranslate"><span class="pre">StrippingSelections</span></code> package and run <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">purge</span> <span class="pre">&amp;&amp;</span> <span class="pre">make</span></code> to build it with your changes.  You can test your changes with the
<code class="docutils literal notranslate"><span class="pre">./run</span></code> script.  It works similar to <code class="docutils literal notranslate"><span class="pre">lb-run</span></code>, without the need to specify a
package and version:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run gaudirun.py options.py
</pre></div>
</div>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="what-if-git-asks-for-my-password?"><i class="fa fa-info-circle"></i> What if git asks for my password?</p>
</div>
<div class="panel-body docutils container">
<p>Make sure you succesfully completed the instructions under <a class="reference external" href="#initial-setup">initial
setup</a>.</p>
</div>
</div>
<p>If you have made changes that you’d like to be integrated into the official
LHCb repositories, you can use <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lb-push</span></code> to push it to a new branch in the
central git repository. But please read the instructions in the <a class="reference external" href="https://twiki.cern.ch/twiki/bin/view/LHCb/Git4LHCb#Using_Git_for_LHCb_development">TWiki
page</a>
first.</p>
<p>Depending on the project, you may be required to document your changes in the
release notes which are found in <code class="docutils literal notranslate"><span class="pre">doc/release.notes</span></code>.</p>
<p>Note that no-one has permission to push directly to the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch of any project.
In order to get your changes merged there from the branch to which you <code class="docutils literal notranslate"><span class="pre">lb-push</span></code>ed, you need to create a merge request, so the project maintainer can inspect your code.
This can be done on the <a class="reference external" href="https://gitlab.cern.ch/lhcb/Stripping/merge_requests/new">project repository web page</a>, for example.</p>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="quick-link-to-create-a-merge-request"><i class="fa fa-info-circle"></i> Quick link to create a merge request</p>
</div>
<div class="panel-body docutils container">
<p>When pushing to a branch in a project in GitLab you will see a message like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>remote:
remote: Create merge request for my-branch:
remote:   https://gitlab.cern.ch/lhcb/Stripping/merge_requests/new?merge_request%5Bsource_branch%5D=my-branch
remote:
</pre></div>
</div>
<p>You can use the URL in the message to quickly create a merge request for the
changes you just pushed.</p>
</div>
</div>
<p>When your merge request is approved (which can be after some additional commits
on your part), your changes are part of the <code class="docutils literal notranslate"><span class="pre">master</span></code> branch of the respective
project, and your contributions are officially part of the LHCb software stack.
Congratulations!</p>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="nightlies"><i class="fa fa-info-circle"></i> Nightlies</p>
</div>
<div class="panel-body docutils container">
<p>It is advisable to test new developments on the so-called <a class="reference external" href="https://lhcb-nightlies.cern.ch">nightly
builds</a>. Each project is built overnight
(hence the name), and all pending merge requests are applied. You can use a
nightly build version of a project with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lb-dev --nightly lhcb-head DaVinci/HEAD
</pre></div>
</div>
<p>A more detailed description of the command is found here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://twiki.cern.ch/twiki/bin/view/LHCb/SoftwareEnvTools">SoftwareEnvTools</a></p></li>
</ul>
<p>Sometimes mistakes happen and the committed code is either not compiling or
does not do what it is supposed to do.  Therefore the nightly tests are
performed. They first try to build the full software stack.</p>
<p>If that is successful, they run some reference jobs and compare the output of
the new build with a reference file.  The results of the nightly builds can
be found here.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://lhcb-nightlies.cern.ch">Nightly builds summaries</a></p></li>
</ul>
<p>If the aim of the commit was to change the ouput, e.g. because you increased
the track reconstruction efficiency by a factor of two, mention it in the
merge request description, such that the manager of the affected project can
update the reference file.</p>
</div>
</div>
<p>If you want to take a look the source code, without checking it out, you can
easily access the repository through the <a class="reference external" href="https://gitlab.cern.ch/lhcb">GitLab web
interface</a>. This website also provides search
functionality, but the output is not always easy to read, especially if it
returns many hits. To search a project much quicker, you can use <code class="docutils literal notranslate"><span class="pre">Lbglimpse</span></code>.
It allows you to search for a given string in the source code of a particular
LHCb project.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Lbglimpse <span class="s2">&quot;PVRefitter&quot;</span> DaVinci v45r1
</pre></div>
</div>
<p>This works with every LHCb project and released version. Since it’s a shell
command, you can easily process the output using <code class="docutils literal notranslate"><span class="pre">less</span></code>, <code class="docutils literal notranslate"><span class="pre">grep</span></code>, and other
tools.</p>
<p>To get an idea of how a certain component of the LHCb software works, you can
also access the doxygen documentation. One set of doxygen web pages is
generated for several related projects, and is linked in all the projects web
sites, like <a class="reference external" href="http://lhcbdoc.web.cern.ch/lhcbdoc/davinci/">for DaVinci</a>.
See also the <a class="reference external" href="http://lhcb.web.cern.ch/lhcb/computing/">LHCb Computing web page</a> for a
list of projects.</p>
<div class="panel panel-callout docutils container">
<div class="panel-header open docutils container">
<p id="working-with-a-full-project-checkout"><i class="fa fa-info-circle"></i> Working with a full project checkout</p>
</div>
<div class="panel-body docutils container">
<p>The <code class="docutils literal notranslate"><span class="pre">lb-git</span></code> commands are not strictly necessary, but they’re very convenient
if you just want to quickly edit one package. Otherwise you’d have to build
the entire project in which the package is residing, instead of using the
precompiled version. However, if you develop across multiple packages, or
want to use more sophisticated <code class="docutils literal notranslate"><span class="pre">git</span></code> commands, nothing prevents you from
checking out an entire project – just don’t be surprised if it takes O(hours)
to compile!</p>
<p>To check out a project, run the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://:@gitlab.cern.ch:8443/lhcb/DaVinci.git
</pre></div>
</div>
<p>replacing <code class="docutils literal notranslate"><span class="pre">DaVinci</span></code> with the project name of your choice. Next, initialise
and compile it:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lb-project-init
make
</pre></div>
</div>
<p>optionally followed by <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">test</span></code> to run the tests and/or <code class="docutils literal notranslate"><span class="pre">make</span> <span class="pre">install</span></code> to
install it to the <code class="docutils literal notranslate"><span class="pre">InstallArea</span></code> directory. That’s all! You now have a vanilla
git repository containing all the source files of the project.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, FCC Starterkit

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>